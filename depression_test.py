import streamlit as st

def run_test():
        # 상단에 이미지 추가
    st.image("dep.png", caption="심리검사", width=600)
    # 상단 타이틀 및 설명
    st.subheader("😔 우울증 자가진단 테스트 (PHQ-9)")

    st.write("지난 2주 동안 당신은 다음의 문제들로 인해 얼마나 자주 방해를 받았습니까?")
    
    # 질문 목록 (PHQ-9 기반)
    questions = [
        "1. 일 또는 여가 활동을 하는데 흥미나 즐거움을 느끼지 못함",
        "2. 기분이 가라앉거나, 우울하거나, 희망이 없음",
        "3. 잠이 들거나 계속 잠을 자는 것이 어려움, 또는 잠을 너무 많이 잠",
        "4. 피곤하다고 느끼거나 기운이 거의 없음",
        "5. 입맛이 없거나 과식을 함",
        "6. 자신을 부정적으로 봄 – 혹은 자신이 실패자라고 느끼거나 자신 또는 가족을 실망시킴",
        "7. 신문을 읽거나 텔레비전 보는 것과 같은 일에 집중하는 것이 어려움",
        "8. 다른 사람들이 주목할 정도로 너무 느리게 움직이거나 말을 함 또는 반대로 평상시보다 많이 움직여서, 너무 안절부절 못하거나 들떠 있음",
        "9. 자신이 죽는 것이 더 낫다고 생각하거나 어떤 식으로든 자신을 해칠 것이라고 생각함"
    ]

    # 점수 옵션
    score_labels = ["0: 전혀 방해받지 않았다", "1: 며칠 동안 방해받았다", "2: 7일 이상 방해받았다", "3: 거의 매일 방해받았다"]

    # 사용자 응답 저장
    responses = []
    for i, question in enumerate(questions):
        st.write(f"{question}")
        score = st.slider("점수 선택:", 0, 3, 0, 1, format="%d", key=f"q{i}")
        responses.append(score)

    # 결과 계산
    if st.button("결과 확인"):
        total_score = sum(responses)
        st.write(f"### 총점: **{total_score} 점**")

        # 우울증 수준 판별
        if total_score <= 4:
            st.success("✅ 정상 (0~4점)\n적응상의 지장을 초래할만한 우울 관련 증상을 거의 보고하지 않았습니다.")
        elif 5 <= total_score <= 9:
            st.info("🔹 경미한 수준 (5~9점)\n경미한 수준의 우울감이 있으나 일상생활에 지장을 줄 정도는 아닙니다.")
        elif 10 <= total_score <= 14:
            st.warning("⚠️ 중간 수준 (10~14점)\n중간 수준의 우울감을 비교적 자주 경험합니다. 직업적, 사회적 적응에 영향을 미칠 수 있으므로 주의가 필요합니다.")
        elif 15 <= total_score <= 19:
            st.warning("⚠️ 약간 심한 수준 (15~19점)\n약간 심한 우울감을 자주 경험합니다. 정신건강 전문가의 상담을 고려해보세요.")
        else:
            st.error("🚨 심한 수준 (20~27점)\n광범위한 우울 증상을 매우 자주, 심한 수준에서 경험합니다. 전문가의 도움을 받는 것이 좋습니다.")

        # 추가 질문
        st.write("\n만일 위의 문제 중 하나 이상이 '예' 라고 응답되었다면, 이러한 문제들로 인해 당신은 **일을 하거나 가정일을 돌보거나 다른 사람과 어울리는 것이 얼마나 어려웠습니까?**")
        severity = st.radio(
            "어려움 정도를 선택하세요:",
            ["전혀 어렵지 않았다", "약간 어려웠다", "많이 어려웠다", "매우 많이 어려웠다"],
            index=0
        )
        st.write(f"🔹 선택한 어려움 정도: **{severity}**")
